<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaGenesis - ë°±í…ŒìŠ¤íŠ¸ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2rem;
            flex-grow: 1;
            text-align: center;
        }

        .nav-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card h2 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .symbol-selection {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            align-items: flex-start;
        }

        .radio-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            min-width: fit-content;
            margin-right: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .radio-group label {
            font-weight: 500;
            color: #2c3e50;
            cursor: pointer;
            font-size: 0.95rem;
            white-space: nowrap;
            margin-bottom: 0 !important;
        }

        .symbol-list {
            display: none;
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 1rem;
            background: #f8f9fa;
        }

        .symbol-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #27ae60, #219a52);
        }

        .btn-danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .btn-warning {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .results-section {
            grid-column: 1 / -1;
            margin-top: 2rem;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .result-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-title {
            font-weight: 600;
            color: #2c3e50;
        }

        .result-date {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .result-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .metric-value {
            font-weight: 600;
        }

        .positive {
            color: #27ae60;
        }

        .negative {
            color: #e74c3c;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s;
        }

        .log-container {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
            border-radius: 12px;
            height: 450px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.8rem;
            line-height: 1.4;
            border: 2px solid #34495e;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .enhanced-log {
            height: 500px !important;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            border: 2px solid #00d4ff;
            border-radius: 15px;
            padding: 1.5rem;
            font-size: 0.8rem;
            line-height: 1.3;
            box-shadow: 0 8px 32px rgba(0, 212, 255, 0.2);
        }

        .log-entry {
            margin: 0.2rem 0;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            border-left: 3px solid #333;
            background: rgba(255, 255, 255, 0.02);
            transition: all 0.2s ease;
            word-wrap: break-word;
            display: flex;
            align-items: center;
            min-height: 28px;
        }

        .log-entry:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(2px);
        }

        /* ì„œë¸Œ ë¡œê·¸ í•­ëª© ìŠ¤íƒ€ì¼ (ë“¤ì—¬ì“°ê¸°ëœ í•­ëª©) - ë” ë‚˜ì€ ê°€ë…ì„± */
        .log-entry.log-sub {
            margin-left: 1.2rem;
            padding: 0.3rem 0.6rem;
            margin-bottom: 0.1rem;
            font-size: 0.75rem;
            border-left-width: 2px;
            background: rgba(255, 255, 255, 0.01);
            opacity: 0.9;
            border-radius: 4px;
            min-height: 24px;
        }

        .log-entry.log-sub:hover {
            transform: translateX(1px);
            opacity: 1;
            background: rgba(255, 255, 255, 0.03);
        }

        .log-system { 
            color: #00d4ff; 
            border-left-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
        }
        .log-data { 
            color: #ffffff; 
            border-left-color: #ffffff;
            background: rgba(255, 255, 255, 0.05);
        }
        .log-strategy { 
            color: #e74c3c; 
            border-left-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }
        .log-market { 
            color: #ffd700; 
            border-left-color: #ffd700;
            background: rgba(255, 215, 0, 0.1);
        }
        .log-analysis { 
            color: #ff6b6b; 
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
        }
        .log-leverage { 
            color: #ff9f43; 
            border-left-color: #ff9f43;
            background: rgba(255, 159, 67, 0.1);
        }
        .log-signal { 
            color: #00ff88; 
            border-left-color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }
        .log-buy { 
            color: #00ff88; 
            border-left-color: #00ff88;
            background: rgba(0, 255, 136, 0.15);
            font-weight: bold;
        }
        .log-buy_add { 
            color: #4ecdc4; 
            border-left-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.15);
            font-weight: bold;
        }
        .log-sell { 
            color: #ff6b6b; 
            border-left-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.15);
            font-weight: bold;
        }
        .log-position { 
            color: #a29bfe; 
            border-left-color: #a29bfe;
            background: rgba(162, 155, 254, 0.1);
        }
        .log-price { 
            color: #fd79a8; 
            border-left-color: #fd79a8;
            background: rgba(253, 121, 168, 0.1);
        }
        .log-profit { 
            color: #00ff88; 
            border-left-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
            font-weight: bold;
            animation: profit-glow 2s ease-in-out infinite;
        }
        .log-result { 
            color: #00ff88; 
            border-left-color: #00ff88;
            background: rgba(0, 255, 136, 0.2);
            font-weight: bold;
            font-size: 1.1rem;
        }
        .log-capital { 
            color: #3498db; 
            border-left-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
            font-weight: bold;
        }
        .log-error {
            color: #ff4757;
            border-left-color: #ff4757;
            background: rgba(255, 71, 87, 0.15);
            font-weight: bold;
        }

        @keyframes profit-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(0, 255, 136, 0.3); }
            50% { box-shadow: 0 0 20px rgba(0, 255, 136, 0.6); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 1rem;
            height: 400px;
        }

        .comparison-section {
            grid-column: 1 / -1;
            margin-top: 2rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        .performance-chart {
            height: 300px;
            background: white;
            border-radius: 10px;
            padding: 1rem;
        }

        .ml-optimization {
            border-left: 4px solid #9b59b6;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
        }

        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .strategy-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ml-badge {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .risk-ë†’ìŒ { 
            background: #ff4757; 
            color: white; 
            padding: 0.2rem 0.5rem; 
            border-radius: 10px; 
            font-size: 0.8rem; 
        }
        .risk-ì¤‘ê°„ { 
            background: #ffa502; 
            color: white; 
            padding: 0.2rem 0.5rem; 
            border-radius: 10px; 
            font-size: 0.8rem; 
        }
        .risk-ë‚®ìŒ { 
            background: #2ed573; 
            color: white; 
            padding: 0.2rem 0.5rem; 
            border-radius: 10px; 
            font-size: 0.8rem; 
        }
        .risk-ë§¤ìš°ë‚®ìŒ { 
            background: #70a1ff; 
            color: white; 
            padding: 0.2rem 0.5rem; 
            border-radius: 10px; 
            font-size: 0.8rem; 
        }

        .positive { color: #27ae60; font-weight: bold; }
        .negative { color: #e74c3c; font-weight: bold; }
        .warning { color: #f39c12; font-weight: bold; }

        #strategyComparisonChart {
            margin-top: 2rem;
            text-align: center;
        }

        #strategyComparisonChart canvas {
            max-width: 100%;
            height: auto;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-running {
            background: #27ae60;
        }

        .status-stopped {
            background: #e74c3c;
        }

        .status-pending {
            background: #f39c12;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .summary-item {
            text-align: center;
            padding: 1rem;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
        }

        .summary-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .summary-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .strategy-categories {
            margin: 2rem 0;
        }

        .strategy-item {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-left: 4px solid #3498db;
        }

        .strategy-item h4 {
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }

        .strategy-item p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }

        .strategy-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .metric-item {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }

        .analysis-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab-button {
            background: none;
            border: none;
            padding: 1rem 2rem;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            color: #3498db;
        }

        .tab-button.active {
            color: #3498db;
            border-bottom-color: #3498db;
            font-weight: bold;
        }

        .tab-content {
            padding: 2rem 0;
        }

        .recommendation-item {
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
        }

        .recommendation-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .recommendation-reason {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
        }

        .recommendation-metrics {
            display: flex;
            gap: 1rem;
            font-size: 0.9rem;
        }

        .comprehensive-analysis-section {
            margin-top: 2rem;
        }

        .priority-ë†’ìŒ {
            color: #e74c3c;
            font-weight: bold;
        }

        .priority-ì¤‘ê°„ {
            color: #f39c12;
            font-weight: bold;
        }

        .priority-ë‚®ìŒ {
            color: #27ae60;
            font-weight: bold;
        }

        .insight-action {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .recommendation-priority {
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }

        .analysis-summary {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .analysis-summary p {
            margin: 0.5rem 0;
        }

        .insights {
            margin-top: 1rem;
        }
        
        /* Responsive Design and Layout Improvements */
        .form-row {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .control-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .btn-start, .btn-stop {
            white-space: nowrap;
            min-width: fit-content;
        }
        
        .comprehensive-description {
            line-height: 1.6;
        }
        
        .comprehensive-description h4 {
            margin: 0 0 0.8rem 0;
            font-size: 1.1rem;
            color: #2c3e50;
        }
        
        .comprehensive-description ul {
            margin: 0.8rem 0;
            padding-left: 1.2rem;
        }
        
        .comprehensive-description li {
            margin-bottom: 0.4rem;
            line-height: 1.5;
        }
        
        .comprehensive-description p {
            margin-bottom: 0.8rem;
            line-height: 1.6;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .symbol-selection {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .radio-group {
                margin-right: 0;
                margin-bottom: 0.5rem;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-row .form-group {
                min-width: 100%;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .btn-start, .btn-stop {
                width: 100%;
                max-width: none;
            }
        }
        
        /* Tablet Responsive */
        @media (max-width: 992px) {
            .container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .form-row .form-group {
                min-width: 150px;
            }
        }

        .insights h5 {
            margin-bottom: 0.5rem;
            color: #3498db;
        }

        .insights ul {
            padding-left: 1.5rem;
        }

        .insights li {
            margin: 0.5rem 0;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .analysis-tabs {
                flex-wrap: wrap;
            }

            .tab-button {
                padding: 0.5rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="/" class="nav-button">
            ğŸ  ë©”ì¸ í˜ì´ì§€
        </a>
        <h1>ğŸš€ AlphaGenesis ë°±í…ŒìŠ¤íŠ¸ ëŒ€ì‹œë³´ë“œ</h1>
        <div style="width: 120px;"></div> <!-- ê· í˜•ì„ ìœ„í•œ ê³µê°„ -->
    </div>

    <div class="container">
        <!-- ë°±í…ŒìŠ¤íŠ¸ ì„¤ì • -->
        <div class="card">
            <h2>ğŸ“Š ë°±í…ŒìŠ¤íŠ¸ ì„¤ì •</h2>
            <form id="backtestForm">
                <div class="form-group">
                    <label for="startDate">ì‹œì‘ì¼</label>
                    <input type="date" id="startDate" name="startDate" required>
                </div>

                <div class="form-group">
                    <label for="endDate">ì¢…ë£Œì¼</label>
                    <input type="date" id="endDate" name="endDate" required>
                </div>

                <div class="form-group">
                    <label>ë°±í…ŒìŠ¤íŠ¸ ëª¨ë“œ</label>
                    <div class="symbol-selection">
                        <div class="radio-group">
                            <input type="radio" id="individualMode" name="backtestMode" value="individual" checked>
                            <label for="individualMode">ê°œë³„ ì „ëµ í…ŒìŠ¤íŠ¸</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="comprehensiveMode" name="backtestMode" value="comprehensive">
                            <label for="comprehensiveMode">ì „ëµ í†µí•© ë¶„ì„</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="portfolioMode" name="backtestMode" value="portfolio">
                            <label for="portfolioMode">í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”</label>
                        </div>
                    </div>
                </div>

                <div class="form-group" id="symbolTypeContainer">
                    <label>ì‹¬ë³¼ ì„ íƒ</label>
                    <div class="symbol-selection">
                        <div class="radio-group">
                            <input type="radio" id="individualSymbol" name="symbolType" value="individual" checked>
                            <label for="individualSymbol">ê°œë³„ ì‹¬ë³¼</label>
                        </div>
                        <div class="radio-group">
                            <input type="radio" id="allSymbols" name="symbolType" value="all">
                            <label for="allSymbols">ì‹œì¥ ì „ì²´</label>
                        </div>
                    </div>
                </div>

                <div class="form-group" id="symbolListContainer">
                    <label for="symbolSelect">ì‹¬ë³¼ ì„ íƒ</label>
                    <select id="symbolSelect" name="symbol">
                        <option value="">ë¡œë”© ì¤‘...</option>
                    </select>
                </div>

                <div class="form-group" id="strategyContainer">
                    <label for="strategy">ì „ëµ ì„ íƒ</label>
                    <select id="strategy" name="strategy" required>
                        <option value="">ì „ëµì„ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>

                <div class="form-group" id="timeframeContainer">
                    <label for="timeframe">ì‹œê°„í”„ë ˆì„</label>
                    <select id="timeframe" name="timeframe" disabled>
                        <option value="">ì „ëµì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>

                <div class="form-group" id="comprehensiveDescription" style="display: none;">
                    <div style="padding: 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; border: 2px solid #e0e0e0;">
                        <h4 style="margin-top: 0; color: white;">ğŸ”¬ ì „ëµ í†µí•© ë¶„ì„ ëª¨ë“œ</h4>
                        <p style="margin-bottom: 0;">ì´ ëª¨ë“œì—ì„œëŠ” ëª¨ë“  ì „ëµì„ ë™ì¼í•œ ë‚ ì§œ ë²”ìœ„ì—ì„œ ë°±í…ŒìŠ¤íŠ¸í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤:</p>
                        <ul style="margin: 0.5rem 0 0 1rem; padding: 0;">
                            <li>ê° ì „ëµì˜ ìƒëŒ€ì  ì„±ê³¼ ë¹„êµ</li>
                            <li>íê¸° ê¶Œì¥ ì „ëµ ì‹ë³„</li>
                            <li>ìˆ˜ì •ì´ í•„ìš”í•œ ì „ëµ ë¶„ì„</li>
                            <li>ì¡°í•© ê°€ëŠ¥í•œ ì „ëµ ì¶”ì²œ</li>
                            <li>ìƒì„¸í•œ ì„±ê³¼ ë¶„ì„ ë° ì¸ì‚¬ì´íŠ¸</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <label for="initialCapital">ì´ˆê¸° ìë³¸ (ì›)</label>
                    <input type="number" id="initialCapital" name="initialCapital" value="10000000" min="1000000" step="1000000">
                </div>

                <div class="form-group">
                    <label>ë™ì  ë ˆë²„ë¦¬ì§€</label>
                    <div id="dynamicLeverageInfo" style="padding: 0.75rem; background: #f8f9fa; border-radius: 10px; border: 2px solid #e0e0e0;">
                        <span id="leverageValue">ìë™ ê³„ì‚°ë¨</span>
                        <div style="font-size: 0.9rem; color: #666; margin-top: 0.5rem;">
                            <span id="leverageReason">ì‹œì¥ ìƒí™©ê³¼ ì „ëµì— ë”°ë¼ ìë™ìœ¼ë¡œ ìµœì í™”ë©ë‹ˆë‹¤</span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="mlOptimization" name="mlOptimization">
                        ML ìµœì í™” ì ìš©
                    </label>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn btn-success" id="startBtn">ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
                    <button type="button" class="btn btn-danger" id="stopBtn">ì¤‘ì§€</button>
                    <button type="button" class="btn btn-warning" id="resetBtn">ì´ˆê¸°í™”</button>
                </div>
            </form>
        </div>

        <!-- ì‹¤ì‹œê°„ ìƒíƒœ -->
        <div class="card">
            <h2>ğŸ“ˆ ì‹¤ì‹œê°„ ìƒíƒœ</h2>
            <div class="form-group">
                <label>ë°±í…ŒìŠ¤íŠ¸ ìƒíƒœ</label>
                <div id="backtestStatus">
                    <span class="status-indicator status-stopped"></span>
                    <span>ëŒ€ê¸° ì¤‘</span>
                </div>
            </div>

            <div class="form-group">
                <label>ì§„í–‰ë¥ </label>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="progressText">0%</div>
            </div>

            <div class="form-group">
                <label>ì‹¤ì‹œê°„ ë¡œê·¸</label>
                <div class="log-container enhanced-log" id="logContainer">
                    <div class="log-entry log-system">ğŸš€ ë°±í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë©´ ë¡œê·¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì„¹ì…˜ -->
    <div class="results-section">
        <div class="card">
            <div class="results-header">
                <h2>ğŸ“Š ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
                <div class="btn-group">
                    <button class="btn" id="compareBtn">ì„±ê³¼ ë¹„êµ</button>
                    <button class="btn" id="exportBtn">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
                    <button class="btn" id="resetBtn" style="background: #e74c3c;">ê²°ê³¼ ì´ˆê¸°í™”</button>
                    <button class="btn" id="statsBtn" style="background: #9b59b6;">í†µê³„ ë³´ê¸°</button>
                </div>
            </div>

            <div class="results-grid" id="resultsGrid">
                <!-- ê²°ê³¼ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>

            <div class="card ml-optimization" id="mlComparisonCard" style="display: none;">
                <h3>ğŸ¤– ML ìµœì í™” ë¹„êµ</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>êµ¬ë¶„</th>
                            <th>ìˆ˜ìµë¥ </th>
                            <th>ìƒ¤í”„ ë¹„ìœ¨</th>
                            <th>ìµœëŒ€ ë‚™í­</th>
                            <th>ìŠ¹ë¥ </th>
                            <th>ê±°ë˜ íšŸìˆ˜</th>
                        </tr>
                    </thead>
                    <tbody id="mlComparisonBody">
                        <!-- ML ë¹„êµ ë°ì´í„°ê°€ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </tbody>
                </table>
            </div>

            <!-- ì„±ê³¼ í†µê³„ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value positive" id="totalReturn">+0.0%</div>
                    <div class="stat-label">ì´ ìˆ˜ìµë¥ </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalTrades">0</div>
                    <div class="stat-label">ì´ ê±°ë˜ íšŸìˆ˜</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="winRate">0.0%</div>
                    <div class="stat-label">ìŠ¹ë¥ </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sharpeRatio">0.0</div>
                    <div class="stat-label">ìƒ¤í”„ ë¹„ìœ¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value negative" id="maxDrawdown">0.0%</div>
                    <div class="stat-label">ìµœëŒ€ ë‚™í­</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="avgLeverage">0.0x</div>
                    <div class="stat-label">í‰ê·  ë ˆë²„ë¦¬ì§€</div>
                </div>
            </div>

            <!-- ì„±ê³¼ ì°¨íŠ¸ -->
            <div class="chart-container">
                <canvas id="performanceChart"></canvas>
            </div>
        </div>
    </div>

    <!-- ì „ëµ ë¹„êµ ì„¹ì…˜ -->
    <div class="comparison-section">
        <div class="card">
            <h2>âš”ï¸ ì „ëµ ì„±ê³¼ ë¹„êµ</h2>
            <div class="comparison-grid">
                <div class="performance-chart">
                    <canvas id="strategyComparisonChart"></canvas>
                </div>
                <div class="performance-chart">
                    <canvas id="riskReturnChart"></canvas>
                </div>
            </div>
            
            <table class="comparison-table" id="strategyComparisonTable">
                <thead>
                    <tr>
                        <th>ì „ëµ</th>
                        <th>ìˆ˜ìµë¥ </th>
                        <th>ìƒ¤í”„ ë¹„ìœ¨</th>
                        <th>ìµœëŒ€ ë‚™í­</th>
                        <th>ìŠ¹ë¥ </th>
                        <th>ê±°ë˜ íšŸìˆ˜</th>
                        <th>í‰ê·  ë ˆë²„ë¦¬ì§€</th>
                        <th>ìœ„í—˜ ë“±ê¸‰</th>
                    </tr>
                </thead>
                <tbody id="strategyComparisonBody">
                    <!-- ì „ëµ ë¹„êµ ë°ì´í„°ê°€ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- ì „ëµ í†µí•© ë¶„ì„ ì„¹ì…˜ -->
    <div class="comprehensive-analysis-section" id="comprehensiveAnalysisSection" style="display: none;">
        <div class="card">
            <h2>ğŸ”¬ ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼</h2>
            
            <!-- ë¶„ì„ ìš”ì•½ -->
            <div class="analysis-summary">
                <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; margin-bottom: 2rem;">
                    <h3 style="color: white;">ğŸ“Š ë¶„ì„ ìš”ì•½</h3>
                    <div class="summary-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div class="summary-item">
                            <div class="summary-value" id="totalStrategiesTested">0</div>
                            <div class="summary-label">í…ŒìŠ¤íŠ¸ëœ ì „ëµ ìˆ˜</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="bestStrategy">-</div>
                            <div class="summary-label">ìµœê³  ì„±ê³¼ ì „ëµ</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="avgReturn">0.0%</div>
                            <div class="summary-label">í‰ê·  ìˆ˜ìµë¥ </div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-value" id="recommendedStrategies">0</div>
                            <div class="summary-label">ì¶”ì²œ ì „ëµ ìˆ˜</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì „ëµ ë¶„ë¥˜ -->
            <div class="strategy-categories">
                <div class="comparison-grid">
                    <!-- ì¶”ì²œ ì „ëµ -->
                    <div class="card" style="border-left: 4px solid #27ae60;">
                        <h3 style="color: #27ae60;">âœ… ì¶”ì²œ ì „ëµ</h3>
                        <div id="recommendedStrategiesList">
                            <!-- ì¶”ì²œ ì „ëµì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ìˆ˜ì • í•„ìš” ì „ëµ -->
                    <div class="card" style="border-left: 4px solid #f39c12;">
                        <h3 style="color: #f39c12;">âš ï¸ ìˆ˜ì • í•„ìš” ì „ëµ</h3>
                        <div id="modificationNeededList">
                            <!-- ìˆ˜ì • í•„ìš” ì „ëµì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- íê¸° ê¶Œì¥ ì „ëµ -->
                    <div class="card" style="border-left: 4px solid #e74c3c;">
                        <h3 style="color: #e74c3c;">âŒ íê¸° ê¶Œì¥ ì „ëµ</h3>
                        <div id="discardRecommendedList">
                            <!-- íê¸° ê¶Œì¥ ì „ëµì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ì¡°í•© ì¶”ì²œ ì „ëµ -->
                    <div class="card" style="border-left: 4px solid #9b59b6;">
                        <h3 style="color: #9b59b6;">ğŸ”— ì¡°í•© ì¶”ì²œ</h3>
                        <div id="combinationRecommendations">
                            <!-- ì¡°í•© ì¶”ì²œì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìƒì„¸ ë¶„ì„ -->
            <div class="detailed-analysis">
                <h3>ğŸ“ˆ ìƒì„¸ ì„±ê³¼ ë¶„ì„</h3>
                <div class="analysis-tabs">
                    <button class="tab-button active" onclick="showAnalysisTab('performance')">ì„±ê³¼ ë¶„ì„</button>
                    <button class="tab-button" onclick="showAnalysisTab('risk')">ìœ„í—˜ ë¶„ì„</button>
                    <button class="tab-button" onclick="showAnalysisTab('correlation')">ìƒê´€ê´€ê³„</button>
                    <button class="tab-button" onclick="showAnalysisTab('insights')">ì¸ì‚¬ì´íŠ¸</button>
                </div>
                
                <div class="tab-content" id="performanceTab">
                    <div class="chart-container">
                        <canvas id="comprehensivePerformanceChart"></canvas>
                    </div>
                    <div id="performanceAnalysis">
                        <!-- ì„±ê³¼ ë¶„ì„ ë‚´ìš© -->
                    </div>
                </div>

                <div class="tab-content" id="riskTab" style="display: none;">
                    <div class="chart-container">
                        <canvas id="riskAnalysisChart"></canvas>
                    </div>
                    <div id="riskAnalysis">
                        <!-- ìœ„í—˜ ë¶„ì„ ë‚´ìš© -->
                    </div>
                </div>

                <div class="tab-content" id="correlationTab" style="display: none;">
                    <div class="chart-container">
                        <canvas id="correlationChart"></canvas>
                    </div>
                    <div id="correlationAnalysis">
                        <!-- ìƒê´€ê´€ê³„ ë¶„ì„ ë‚´ìš© -->
                    </div>
                </div>

                <div class="tab-content" id="insightsTab" style="display: none;">
                    <div id="insightsContent">
                        <!-- ì¸ì‚¬ì´íŠ¸ ë‚´ìš© -->
                    </div>
                </div>
            </div>

            <!-- ì•¡ì…˜ ë²„íŠ¼ -->
            <div class="btn-group" style="margin-top: 2rem;">
                <button class="btn btn-success" onclick="exportComprehensiveAnalysis()">ë¶„ì„ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ</button>
                <button class="btn" onclick="generateOptimizedPortfolio()">ìµœì í™” í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±</button>
                <button class="btn btn-warning" onclick="resetComprehensiveAnalysis()">ë¶„ì„ ì´ˆê¸°í™”</button>
            </div>
        </div>
    </div>

    <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
    <div id="detailModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>ë°±í…ŒìŠ¤íŠ¸ ìƒì„¸ ì •ë³´</h2>
            <div id="detailContent">
                <!-- ìƒì„¸ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentBacktestId = null;
        let eventSource = null;
        let strategies = [];
        let symbols = [];

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeDates();
            loadStrategies();
            loadSymbols();
            loadBacktestResults();
            setupEventListeners();
        });

        // ë‚ ì§œ ì´ˆê¸°í™” (ì‹œì‘ì¼: 1ë‹¬ ì „, ì¢…ë£Œì¼: ì˜¤ëŠ˜)
        function initializeDates() {
            const today = new Date();
            const oneMonthAgo = new Date();
            oneMonthAgo.setMonth(today.getMonth() - 1);

            document.getElementById('startDate').value = oneMonthAgo.toISOString().split('T')[0];
            document.getElementById('endDate').value = today.toISOString().split('T')[0];
        }

        // ì „ëµ ëª©ë¡ ë¡œë“œ
        async function loadStrategies() {
            try {
                const response = await fetch('/api/strategies');
                const data = await response.json();
                strategies = data.strategies || [];
                
                const strategySelect = document.getElementById('strategy');
                strategySelect.innerHTML = '<option value="">ì „ëµì„ ì„ íƒí•˜ì„¸ìš”</option>';
                
                strategies.forEach(strategy => {
                    const option = document.createElement('option');
                    option.value = strategy.id;
                    option.textContent = strategy.name;
                    option.dataset.timeframe = strategy.timeframe;
                    strategySelect.appendChild(option);
                });
            } catch (error) {
                console.error('ì „ëµ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ì‹¬ë³¼ ëª©ë¡ ë¡œë“œ
        async function loadSymbols() {
            try {
                const response = await fetch('/api/binance/symbols');
                const data = await response.json();
                symbols = data.symbols || [];
                
                const symbolSelect = document.getElementById('symbolSelect');
                symbolSelect.innerHTML = '<option value="">ì‹¬ë³¼ì„ ì„ íƒí•˜ì„¸ìš”</option>';
                
                symbols.forEach(symbol => {
                    const option = document.createElement('option');
                    option.value = symbol;
                    option.textContent = symbol;
                    symbolSelect.appendChild(option);
                });
            } catch (error) {
                console.error('ì‹¬ë³¼ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ë°±í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì „í™˜
        function toggleBacktestMode(mode) {
            const symbolTypeContainer = document.getElementById('symbolTypeContainer');
            const symbolListContainer = document.getElementById('symbolListContainer');
            const strategyContainer = document.getElementById('strategyContainer');
            const timeframeContainer = document.getElementById('timeframeContainer');
            const comprehensiveDescription = document.getElementById('comprehensiveDescription');
            const strategy = document.getElementById('strategy');
            const startBtn = document.getElementById('startBtn');

            if (mode === 'comprehensive') {
                // ì „ëµ í†µí•© ë¶„ì„ ëª¨ë“œ
                symbolTypeContainer.style.display = 'none';
                symbolListContainer.style.display = 'none';
                strategyContainer.style.display = 'none';
                timeframeContainer.style.display = 'none';
                comprehensiveDescription.style.display = 'block';
                
                // ì „ëµ ì„ íƒì„ í•„ìˆ˜ê°€ ì•„ë‹ˆê²Œ ë§Œë“¤ê¸°
                strategy.removeAttribute('required');
                
                // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                startBtn.textContent = 'ì „ëµ í†µí•© ë¶„ì„ ì‹œì‘';
            } else {
                // ê°œë³„ ì „ëµ í…ŒìŠ¤íŠ¸ ëª¨ë“œ
                symbolTypeContainer.style.display = 'block';
                symbolListContainer.style.display = 'block';
                strategyContainer.style.display = 'block';
                timeframeContainer.style.display = 'block';
                comprehensiveDescription.style.display = 'none';
                
                // ì „ëµ ì„ íƒì„ í•„ìˆ˜ë¡œ ë§Œë“¤ê¸°
                strategy.setAttribute('required', 'required');
                
                // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
                startBtn.textContent = 'ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘';
                
                // ì‹¬ë³¼ íƒ€ì…ì— ë”°ë¼ ì‹¬ë³¼ ì„ íƒ í‘œì‹œ/ìˆ¨ê¹€
                const symbolTypeValue = document.querySelector('input[name="symbolType"]:checked').value;
                if (symbolTypeValue === 'all') {
                    symbolListContainer.style.display = 'none';
                } else {
                    symbolListContainer.style.display = 'block';
                }
            }
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            // ë°±í…ŒìŠ¤íŠ¸ ëª¨ë“œ ë³€ê²½
            document.querySelectorAll('input[name="backtestMode"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    toggleBacktestMode(this.value);
                });
            });

            // ì „ëµ ì„ íƒ ì‹œ ì‹œê°„í”„ë ˆì„ ìë™ ì„¤ì •
            document.getElementById('strategy').addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                const timeframe = selectedOption.dataset.timeframe;
                const timeframeSelect = document.getElementById('timeframe');
                
                if (timeframe) {
                    timeframeSelect.innerHTML = `<option value="${timeframe}">${timeframe}</option>`;
                    timeframeSelect.disabled = true;
                } else {
                    timeframeSelect.innerHTML = '<option value="">ì „ëµì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';
                    timeframeSelect.disabled = true;
                }
            });

            // ì‹¬ë³¼ íƒ€ì… ë³€ê²½
            document.querySelectorAll('input[name="symbolType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const symbolListContainer = document.getElementById('symbolListContainer');
                    if (this.value === 'all') {
                        symbolListContainer.style.display = 'none';
                    } else {
                        symbolListContainer.style.display = 'block';
                    }
                });
            });

            // ë°±í…ŒìŠ¤íŠ¸ í¼ ì œì¶œ
            document.getElementById('backtestForm').addEventListener('submit', function(e) {
                e.preventDefault();
                startBacktest();
            });

            // ì •ì§€ ë²„íŠ¼
            document.getElementById('stopBtn').addEventListener('click', stopBacktest);

            // ë¹„êµ ë²„íŠ¼
            document.getElementById('compareBtn').addEventListener('click', showComparison);

            // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
            document.getElementById('exportBtn').addEventListener('click', exportToExcel);

            // ê²°ê³¼ ì´ˆê¸°í™” ë²„íŠ¼
            document.getElementById('resetBtn').addEventListener('click', resetBacktestResults);

            // í†µê³„ ë³´ê¸° ë²„íŠ¼
            document.getElementById('statsBtn').addEventListener('click', showStatistics);

            // ëª¨ë‹¬ ë‹«ê¸°
            document.querySelector('.close').addEventListener('click', function() {
                document.getElementById('detailModal').style.display = 'none';
            });
        }

        // ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘
        async function startBacktest() {
            const formData = new FormData(document.getElementById('backtestForm'));
            const data = Object.fromEntries(formData);
            
            // ë°±í…ŒìŠ¤íŠ¸ ëª¨ë“œ í™•ì¸
            const backtestMode = document.querySelector('input[name="backtestMode"]:checked').value;
            
            // í¼ ë°ì´í„° ê²€ì¦ ë° ì •ë¦¬
            const backtestConfig = {
                startDate: data.startDate || document.getElementById('startDate').value,
                endDate: data.endDate || document.getElementById('endDate').value,
                backtestMode: backtestMode,
                initialCapital: data.initialCapital || document.getElementById('initialCapital').value,
                mlOptimization: data.mlOptimization || document.getElementById('mlOptimization').checked
            };

            // ê°œë³„ ì „ëµ í…ŒìŠ¤íŠ¸ ëª¨ë“œì¸ ê²½ìš°ì—ë§Œ ì „ëµ ê´€ë ¨ ì •ë³´ ì¶”ê°€
            if (backtestMode === 'individual') {
                backtestConfig.strategy = data.strategy || document.getElementById('strategy').value;
                backtestConfig.symbolType = data.symbolType || document.querySelector('input[name="symbolType"]:checked').value;
                backtestConfig.symbol = data.symbol || document.getElementById('symbolSelect').value;
                backtestConfig.timeframe = data.timeframe || document.getElementById('timeframe').value;
            }

            // ë¡œê·¸ì— ì„¤ì • ì •ë³´ í‘œì‹œ
            const logContainer = document.getElementById('logContainer');
            
            if (backtestMode === 'comprehensive') {
                logContainer.innerHTML = `
                    <div class="log-entry log-system">ğŸš€ ì „ëµ í†µí•© ë¶„ì„ ì‹œì‘</div>
                    <div class="log-entry log-data">ğŸ“Š ì„¤ì • ì •ë³´:</div>
                    <div class="log-entry log-data">  ğŸ“… ê¸°ê°„: ${backtestConfig.startDate} ~ ${backtestConfig.endDate}</div>
                    <div class="log-entry log-data">  ğŸ¯ ëª¨ë“œ: ì „ëµ í†µí•© ë¶„ì„</div>
                    <div class="log-entry log-data">  ğŸ’° ì´ˆê¸°ìë³¸: ${Number(backtestConfig.initialCapital).toLocaleString()}ì›</div>
                    <div class="log-entry log-data">  ğŸ“ˆ ì‹¬ë³¼: ì „ì²´ ì‹œì¥</div>
                    <div class="log-entry log-system">  ğŸ¤– ML ìµœì í™”: ${backtestConfig.mlOptimization ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}</div>
                    <div class="log-entry log-analysis">ğŸ”¬ ëª¨ë“  ì „ëµì„ í…ŒìŠ¤íŠ¸í•˜ê³  ì„±ê³¼ ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤...</div>
                `;
            } else {
                logContainer.innerHTML = `
                    <div class="log-entry log-system">ğŸš€ ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘</div>
                    <div class="log-entry log-data">ğŸ“Š ì„¤ì • ì •ë³´:</div>
                    <div class="log-entry log-data">  ğŸ“… ê¸°ê°„: ${backtestConfig.startDate} ~ ${backtestConfig.endDate}</div>
                    <div class="log-entry log-data">  ğŸ¯ ì „ëµ: ${backtestConfig.strategy}</div>
                    <div class="log-entry log-data">  ğŸ’° ì´ˆê¸°ìë³¸: ${Number(backtestConfig.initialCapital).toLocaleString()}ì›</div>
                    <div class="log-entry log-data">  ğŸ“ˆ ì‹¬ë³¼: ${backtestConfig.symbolType === 'all' ? 'ì „ì²´ ì‹œì¥' : backtestConfig.symbol}</div>
                    <div class="log-entry log-data">  â° ì‹œê°„í”„ë ˆì„: ${backtestConfig.timeframe}</div>
                    <div class="log-entry log-system">  ğŸ¤– ML ìµœì í™”: ${backtestConfig.mlOptimization ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}</div>
                `;
            }

            try {
                updateStatus('running', backtestMode === 'comprehensive' ? 'ì „ëµ í†µí•© ë¶„ì„ ì‹œì‘ ì¤‘...' : 'ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘ ì¤‘...');
                
                let endpoint;
                if (backtestMode === 'comprehensive') {
                    endpoint = '/api/backtest/comprehensive';
                } else if (backtestMode === 'portfolio') {
                    endpoint = '/api/portfolio/analyze';
                } else {
                    endpoint = '/api/backtest/run';
                }
                const response = await fetch(endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(backtestConfig)
                });

                const result = await response.json();
                
                if (result.error) {
                    throw new Error(result.error);
                }

                currentBacktestId = result.backtest_id;
                startLogStream();
                
            } catch (error) {
                console.error('ë°±í…ŒìŠ¤íŠ¸ ì‹œì‘ ì‹¤íŒ¨:', error);
                updateStatus('stopped', 'ë°±í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + error.message);
                logContainer.innerHTML += `<div class="log-entry log-error">âŒ ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        // ë°±í…ŒìŠ¤íŠ¸ ì¤‘ì§€
        async function stopBacktest() {
            try {
                await fetch('/api/backtest/stop', { method: 'POST' });
                updateStatus('stopped', 'ë°±í…ŒìŠ¤íŠ¸ ì¤‘ì§€ë¨');
                if (eventSource) {
                    eventSource.close();
                    eventSource = null;
                }
            } catch (error) {
                console.error('ë°±í…ŒìŠ¤íŠ¸ ì¤‘ì§€ ì‹¤íŒ¨:', error);
            }
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus(status, message) {
            const statusElement = document.getElementById('backtestStatus');
            const indicator = statusElement.querySelector('.status-indicator');
            const text = statusElement.querySelector('span:last-child');
            
            indicator.className = `status-indicator status-${status}`;
            text.textContent = message;
        }

        // ë¡œê·¸ ìŠ¤íŠ¸ë¦¼ ì‹œì‘
        function startLogStream() {
            if (eventSource) {
                eventSource.close();
            }

            // ë°±í…ŒìŠ¤íŠ¸ ì„¤ì • íŒŒë¼ë¯¸í„° ì¤€ë¹„
            const params = new URLSearchParams({
                start_date: document.getElementById('startDate').value,
                end_date: document.getElementById('endDate').value,
                symbol: document.querySelector('input[name="symbolType"]:checked').value === 'all' ? 'ALL_MARKET' : document.getElementById('symbolSelect').value,
                strategy: document.getElementById('strategy').value
            });

            eventSource = new EventSource(`/api/backtest/stream_log?${params.toString()}`);
            
            eventSource.onmessage = function(event) {
                const data = JSON.parse(event.data);
                
                if (data.type === 'end') {
                    const backtestMode = document.querySelector('input[name="backtestMode"]:checked').value;
                    
                    if (backtestMode === 'comprehensive') {
                        updateStatus('stopped', 'ì „ëµ í†µí•© ë¶„ì„ ì™„ë£Œ');
                        
                        // ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼ ì²˜ë¦¬
                        if (data.comprehensive_analysis) {
                            displayComprehensiveAnalysis(data.comprehensive_analysis);
                        } else {
                            // í…ŒìŠ¤íŠ¸ìš© ë”ë¯¸ ë°ì´í„° í‘œì‹œ
                            testComprehensiveAnalysis();
                        }
                    } else {
                        updateStatus('stopped', 'ë°±í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
                        loadBacktestResults();
                        updateStatistics();
                    }
                    
                    eventSource.close();
                    eventSource = null;
                    return;
                }

                // ë¡œê·¸ ì¶”ê°€ (íƒ€ì…ë³„ ìƒ‰ìƒ ì ìš© + ì„œë¸Œ ë¡œê·¸ ê°ì§€)
                const logContainer = document.getElementById('logContainer');
                const logEntry = document.createElement('div');
                const message = data.message || event.data;
                
                // ì„œë¸Œ ë¡œê·¸ ê°ì§€ (ë“¤ì—¬ì“°ê¸°ëœ í•­ëª©)
                const isSubLog = message.includes('â””â”€');
                const baseClass = `log-entry log-${data.type || 'system'}`;
                logEntry.className = isSubLog ? `${baseClass} log-sub` : baseClass;
                logEntry.textContent = message;
                
                logContainer.appendChild(logEntry);
                logContainer.scrollTop = logContainer.scrollHeight;

                // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                if (data.progress) {
                    updateProgress(data.progress);
                }
            };

            eventSource.onerror = function(event) {
                console.error('EventSource ì—°ê²° ì˜¤ë¥˜:', event);
                updateStatus('stopped', 'ì—°ê²° ì˜¤ë¥˜ ë°œìƒ');
            };
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics() {
            // ë”ë¯¸ í†µê³„ ë°ì´í„° (ì‹¤ì œë¡œëŠ” ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ì—ì„œ ê°€ì ¸ì˜´)
            const stats = {
                totalReturn: 25.4,
                totalTrades: 45,
                winRate: 68.9,
                sharpeRatio: 1.85,
                maxDrawdown: 8.5,
                avgLeverage: 2.4
            };

            document.getElementById('totalReturn').textContent = `+${stats.totalReturn}%`;
            document.getElementById('totalTrades').textContent = stats.totalTrades;
            document.getElementById('winRate').textContent = `${stats.winRate}%`;
            document.getElementById('sharpeRatio').textContent = stats.sharpeRatio;
            document.getElementById('maxDrawdown').textContent = `${stats.maxDrawdown}%`;
            document.getElementById('avgLeverage').textContent = `${stats.avgLeverage}x`;

            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updatePerformanceChart();
            updateStrategyComparisonChart();
        }

        // ì„±ê³¼ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updatePerformanceChart() {
            const ctx = document.getElementById('performanceChart');
            if (!ctx) return;

            // Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤
            // ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ canvas APIë¡œ ê°„ë‹¨í•œ ì°¨íŠ¸ ê·¸ë¦¬ê¸°
            const canvas = ctx.getContext('2d');
            canvas.clearRect(0, 0, ctx.width, ctx.height);
            
            // ìƒ˜í”Œ ë°ì´í„°ë¡œ ì„  ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
            const data = [100, 102, 98, 105, 110, 108, 115, 120, 118, 125];
            const width = ctx.width;
            const height = ctx.height;
            const margin = 20;
            
            canvas.strokeStyle = '#3498db';
            canvas.lineWidth = 2;
            canvas.beginPath();
            
            for (let i = 0; i < data.length; i++) {
                const x = margin + (i * (width - 2 * margin)) / (data.length - 1);
                const y = height - margin - ((data[i] - 90) * (height - 2 * margin)) / 40;
                
                if (i === 0) {
                    canvas.moveTo(x, y);
                } else {
                    canvas.lineTo(x, y);
                }
            }
            
            canvas.stroke();
        }

        // ì „ëµ ë¹„êµ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updateStrategyComparisonChart() {
            // ì „ëµ ë¹„êµ í…Œì´ë¸” ì—…ë°ì´íŠ¸
            const strategies = [
                { name: 'íŠ¸ë¦¬í”Œ ì½¤ë³´', return: 25.4, sharpe: 1.85, drawdown: 8.5, winRate: 68.9, trades: 45, leverage: 2.4, risk: 'ì¤‘ê°„', mlOptimized: true },
                { name: 'RSI ì „ëµ', return: 18.2, sharpe: 1.32, drawdown: 12.3, winRate: 58.5, trades: 78, leverage: 1.8, risk: 'ë‚®ìŒ', mlOptimized: false },
                { name: 'MACD ì „ëµ', return: 22.1, sharpe: 1.65, drawdown: 15.2, winRate: 62.5, trades: 32, leverage: 2.1, risk: 'ì¤‘ê°„', mlOptimized: true },
                { name: 'ëª¨ë©˜í…€ ì „ëµ', return: 31.8, sharpe: 2.05, drawdown: 18.7, winRate: 60.7, trades: 28, leverage: 3.2, risk: 'ë†’ìŒ', mlOptimized: true },
                { name: 'ML ì•™ìƒë¸”', return: 28.6, sharpe: 2.15, drawdown: 11.4, winRate: 71.2, trades: 52, leverage: 2.8, risk: 'ì¤‘ê°„', mlOptimized: true },
                { name: 'ë³¼ë¦°ì € ë°´ë“œ', return: 19.8, sharpe: 1.45, drawdown: 10.2, winRate: 65.3, trades: 41, leverage: 2.0, risk: 'ë‚®ìŒ', mlOptimized: false },
                { name: 'ê·¸ë¦¬ë“œ íŠ¸ë ˆì´ë”©', return: 15.6, sharpe: 1.12, drawdown: 7.8, winRate: 72.5, trades: 95, leverage: 1.5, risk: 'ë‚®ìŒ', mlOptimized: false },
                { name: 'ì°¨ìµê±°ë˜', return: 12.3, sharpe: 1.85, drawdown: 3.2, winRate: 85.2, trades: 156, leverage: 1.2, risk: 'ë§¤ìš°ë‚®ìŒ', mlOptimized: false }
            ];

            const tbody = document.getElementById('strategyComparisonBody');
            if (tbody) {
                tbody.innerHTML = '';

                strategies.forEach(strategy => {
                    const row = document.createElement('tr');
                    const returnClass = strategy.return > 0 ? 'positive' : 'negative';
                    const riskClass = strategy.risk === 'ë†’ìŒ' ? 'negative' : strategy.risk === 'ì¤‘ê°„' ? 'warning' : 'positive';
                    
                    row.innerHTML = `
                        <td>
                            <div class="strategy-name">
                                <strong>${strategy.name}</strong>
                                ${strategy.mlOptimized ? '<span class="ml-badge">ğŸ¤– ML</span>' : ''}
                            </div>
                        </td>
                        <td class="${returnClass}">${strategy.return > 0 ? '+' : ''}${strategy.return}%</td>
                        <td>${strategy.sharpe}</td>
                        <td class="negative">${strategy.drawdown}%</td>
                        <td>${strategy.winRate}%</td>
                        <td>${strategy.trades}</td>
                        <td>${strategy.leverage}x</td>
                        <td><span class="risk-${strategy.risk}">${strategy.risk}</span></td>
                    `;
                    tbody.appendChild(row);
                });
            }

            // ì „ëµ ë¹„êµ ì°¨íŠ¸ ìƒì„±
            createStrategyComparisonChart(strategies);
        }

        // ì „ëµ ë¹„êµ ì°¨íŠ¸ ìƒì„±
        function createStrategyComparisonChart(strategies) {
            const chartContainer = document.getElementById('strategyComparisonChart');
            if (!chartContainer) return;

            // ì°¨íŠ¸ ë°ì´í„° ì¤€ë¹„
            const labels = strategies.map(s => s.name);
            const returns = strategies.map(s => s.return);
            const sharpeRatios = strategies.map(s => s.sharpe);

            // ê°„ë‹¨í•œ ë§‰ëŒ€ ì°¨íŠ¸ ìƒì„± (Canvas API ì‚¬ìš©)
            const canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 400;
            canvas.id = 'strategyChart';
            
            chartContainer.innerHTML = '';
            chartContainer.appendChild(canvas);

            const ctx = canvas.getContext('2d');
            
            // ì°¨íŠ¸ ì„¤ì •
            const padding = 60;
            const chartWidth = canvas.width - 2 * padding;
            const chartHeight = canvas.height - 2 * padding;
            const barWidth = chartWidth / strategies.length * 0.8;
            const maxReturn = Math.max(...returns);
            const minReturn = Math.min(...returns);
            const range = maxReturn - minReturn;

            // ë°°ê²½ ê·¸ë¦¬ê¸°
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ê²©ì ê·¸ë¦¬ê¸°
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const y = padding + (chartHeight / 10) * i;
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }

            // ë§‰ëŒ€ ê·¸ë¦¬ê¸°
            strategies.forEach((strategy, i) => {
                const x = padding + (chartWidth / strategies.length) * i + (chartWidth / strategies.length - barWidth) / 2;
                const barHeight = (strategy.return / maxReturn) * chartHeight * 0.8;
                const y = padding + chartHeight - barHeight;

                // ë§‰ëŒ€ ìƒ‰ìƒ (ML ìµœì í™” ì—¬ë¶€ì— ë”°ë¼)
                ctx.fillStyle = strategy.mlOptimized ? '#00d4ff' : '#3498db';
                ctx.fillRect(x, y, barWidth, barHeight);

                // ê°’ í‘œì‹œ
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(`${strategy.return}%`, x + barWidth / 2, y - 5);

                // ë¼ë²¨ í‘œì‹œ
                ctx.save();
                ctx.translate(x + barWidth / 2, canvas.height - 20);
                ctx.rotate(-Math.PI / 4);
                ctx.textAlign = 'right';
                ctx.fillText(strategy.name, 0, 0);
                ctx.restore();
            });

            // ë²”ë¡€ ì¶”ê°€
            ctx.fillStyle = '#00d4ff';
            ctx.fillRect(10, 10, 15, 15);
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('ML ìµœì í™”', 30, 22);

            ctx.fillStyle = '#3498db';
            ctx.fillRect(10, 30, 15, 15);
            ctx.fillStyle = '#333';
            ctx.fillText('ê¸°ë³¸ ì „ëµ', 30, 42);
        }

        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateProgress(progress) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressFill.style.width = progress + '%';
            progressText.textContent = progress + '%';
        }

        // ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œë“œ
        async function loadBacktestResults() {
            try {
                const response = await fetch('/api/backtest/results');
                const data = await response.json();
                
                if (data.results) {
                    displayResults(data.results);
                }
            } catch (error) {
                console.error('ê²°ê³¼ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ê²°ê³¼ í‘œì‹œ
        function displayResults(results) {
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.innerHTML = '';

            results.forEach((result, index) => {
                const resultCard = createResultCard(result, index);
                resultsGrid.appendChild(resultCard);
            });
        }

        // ê²°ê³¼ ì¹´ë“œ ìƒì„±
        function createResultCard(result, index) {
            const card = document.createElement('div');
            card.className = 'result-card';
            card.onclick = () => showDetailModal(result);
            
            const totalReturn = ((result.final_value - result.initial_capital) / result.initial_capital * 100).toFixed(2);
            const isProfit = totalReturn > 0;
            
            card.innerHTML = `
                <div class="result-header">
                    <div class="result-title">${result.strategy_name}</div>
                    <div class="result-date">${new Date(result.created_at).toLocaleDateString()}</div>
                </div>
                <div class="result-metrics">
                    <div class="metric">
                        <span>ìˆ˜ìµë¥ </span>
                        <span class="metric-value ${isProfit ? 'positive' : 'negative'}">${totalReturn}%</span>
                    </div>
                    <div class="metric">
                        <span>ìƒ¤í”„ ë¹„ìœ¨</span>
                        <span class="metric-value">${result.sharpe_ratio?.toFixed(2) || 'N/A'}</span>
                    </div>
                    <div class="metric">
                        <span>ìµœëŒ€ ë‚™í­</span>
                        <span class="metric-value negative">${result.max_drawdown?.toFixed(2) || 'N/A'}%</span>
                    </div>
                    <div class="metric">
                        <span>ìŠ¹ë¥ </span>
                        <span class="metric-value">${result.win_rate?.toFixed(2) || 'N/A'}%</span>
                    </div>
                    <div class="metric">
                        <span>ê±°ë˜ íšŸìˆ˜</span>
                        <span class="metric-value">${result.total_trades || 0}</span>
                    </div>
                    <div class="metric">
                        <span>ì‹¬ë³¼</span>
                        <span class="metric-value">${result.symbol}</span>
                    </div>
                </div>
                ${result.ml_optimized ? '<div style="color: #9b59b6; font-weight: bold;">ğŸ¤– ML ìµœì í™” ì ìš©</div>' : ''}
            `;
            
            return card;
        }

        // ìƒì„¸ ëª¨ë‹¬ í‘œì‹œ
        async function showDetailModal(result) {
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('detailContent');
            
            // ë§¤ë§¤ ê¸°ë¡ ê°€ì ¸ì˜¤ê¸°
            let trades = [];
            try {
                const response = await fetch(`/api/backtest/results/${result.id}`);
                const data = await response.json();
                trades = data.trades || [];
            } catch (error) {
                console.error('ë§¤ë§¤ ê¸°ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
            
            content.innerHTML = `
                <div class="detail-section">
                    <h3>ê¸°ë³¸ ì •ë³´</h3>
                    <table class="comparison-table">
                        <tr><td>ì „ëµ</td><td>${result.strategy_name}</td></tr>
                        <tr><td>ì‹¬ë³¼</td><td>${result.symbol}</td></tr>
                        <tr><td>ì‹œê°„í”„ë ˆì„</td><td>${result.timeframe}</td></tr>
                        <tr><td>ê¸°ê°„</td><td>${result.start_date} ~ ${result.end_date}</td></tr>
                        <tr><td>ë ˆë²„ë¦¬ì§€</td><td>${result.leverage || result.avg_leverage ? `ë™ì  (í‰ê·  ${result.avg_leverage?.toFixed(1) || 1.0}x)` : '1.0x'}</td></tr>
                        <tr><td>ì´ˆê¸° ìë³¸</td><td>${result.initial_capital.toLocaleString()}ì›</td></tr>
                    </table>
                </div>
                
                <div class="detail-section">
                    <h3>ì„±ê³¼ ì§€í‘œ</h3>
                    <table class="comparison-table">
                        <tr><td>ìµœì¢… ìì‚°</td><td>${result.final_value.toLocaleString()}ì›</td></tr>
                        <tr><td>ì´ ìˆ˜ìµë¥ </td><td>${((result.final_value - result.initial_capital) / result.initial_capital * 100).toFixed(2)}%</td></tr>
                        <tr><td>ìƒ¤í”„ ë¹„ìœ¨</td><td>${result.sharpe_ratio?.toFixed(2) || 'N/A'}</td></tr>
                        <tr><td>ìµœëŒ€ ë‚™í­</td><td>${result.max_drawdown?.toFixed(2) || 'N/A'}%</td></tr>
                        <tr><td>ìŠ¹ë¥ </td><td>${result.win_rate?.toFixed(2) || 'N/A'}%</td></tr>
                        <tr><td>ì´ ê±°ë˜ íšŸìˆ˜</td><td>${result.total_trades || 0}</td></tr>
                        <tr><td>ìˆ˜ìµ ê±°ë˜</td><td>${result.winning_trades || 0}</td></tr>
                        <tr><td>ì†ì‹¤ ê±°ë˜</td><td>${result.losing_trades || 0}</td></tr>
                    </table>
                </div>
                
                ${trades.length > 0 ? `
                <div class="detail-section">
                    <h3>ë§¤ë§¤ ê¸°ë¡</h3>
                    <div style="max-height: 400px; overflow-y: auto;">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>ì‹œê°„</th>
                                    <th>ìœ í˜•</th>
                                    <th>ê°€ê²©</th>
                                    <th>ìˆ˜ëŸ‰</th>
                                    <th>ë ˆë²„ë¦¬ì§€</th>
                                    <th>ì†ìµ</th>
                                    <th>ì†ìµë¥ </th>
                                    <th>ì”ì•¡</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${trades.map(trade => `
                                    <tr>
                                        <td>${new Date(trade.timestamp).toLocaleString()}</td>
                                        <td>${trade.type === 'buy' ? 'ë§¤ìˆ˜' : 'ë§¤ë„'}</td>
                                        <td>${trade.price?.toFixed(2) || 'N/A'}</td>
                                        <td>${trade.amount?.toFixed(4) || 'N/A'}</td>
                                        <td>${trade.leverage?.toFixed(1) || '1.0'}x</td>
                                        <td class="${trade.pnl > 0 ? 'positive' : trade.pnl < 0 ? 'negative' : ''}">${trade.pnl?.toFixed(0) || '0'}ì›</td>
                                        <td class="${trade.pnl_percent > 0 ? 'positive' : trade.pnl_percent < 0 ? 'negative' : ''}">${trade.pnl_percent?.toFixed(2) || '0.00'}%</td>
                                        <td>${trade.balance_after?.toLocaleString() || 'N/A'}ì›</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
                ` : '<div class="detail-section"><p>ë§¤ë§¤ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>'}
                
                <div class="btn-group">
                    <button class="btn" onclick="exportResultToExcel(${result.id})">ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            document.getElementById('backtestForm').reset();
            initializeDates();
            updateStatus('stopped', 'ëŒ€ê¸° ì¤‘');
            updateProgress(0);
            document.getElementById('logContainer').innerHTML = 'ë°±í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ë©´ ë¡œê·¸ê°€ í‘œì‹œë©ë‹ˆë‹¤.';
        }

        // ì„±ê³¼ ë¹„êµ í‘œì‹œ
        async function showComparison() {
            try {
                // ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¡œë“œ
                const response = await fetch('/api/backtest/results');
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }

                const results = data.results || [];
                if (results.length === 0) {
                    alert('ë¹„êµí•  ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // ì „ëµë³„ ì„±ê³¼ ë¹„êµ ì„¹ì…˜ í‘œì‹œ
                const comparisonSection = document.querySelector('.comparison-section');
                comparisonSection.style.display = 'block';

                // ì „ëµë³„ ë°ì´í„° ê·¸ë£¹í™”
                const strategyData = {};
                results.forEach(result => {
                    const strategyName = result.strategy_name;
                    if (!strategyData[strategyName]) {
                        strategyData[strategyName] = {
                            returns: [],
                            sharpe: [],
                            drawdown: [],
                            winRate: [],
                            totalTrades: 0,
                            avgLeverage: 0,
                            count: 0
                        };
                    }
                    
                    const totalReturn = ((result.final_value - result.initial_capital) / result.initial_capital * 100);
                    strategyData[strategyName].returns.push(totalReturn);
                    strategyData[strategyName].sharpe.push(result.sharpe_ratio);
                    strategyData[strategyName].drawdown.push(result.max_drawdown);
                    strategyData[strategyName].winRate.push(result.win_rate);
                    strategyData[strategyName].totalTrades += result.total_trades;
                    strategyData[strategyName].avgLeverage += result.avg_leverage;
                    strategyData[strategyName].count++;
                });

                // ì „ëµ ë¹„êµ ì°¨íŠ¸ ìƒì„±
                createStrategyComparisonChart(strategyData);
                createRiskReturnChart(strategyData);
                
                // ì „ëµ ë¹„êµ í…Œì´ë¸” ì—…ë°ì´íŠ¸
                updateStrategyComparisonTable(strategyData);
                
                // ì„±ê³¼ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
                updatePerformanceChart(results);

                // ë¶€ë“œëŸ½ê²Œ ìŠ¤í¬ë¡¤
                comparisonSection.scrollIntoView({ behavior: 'smooth' });

            } catch (error) {
                console.error('ì„±ê³¼ ë¹„êµ ì‹¤íŒ¨:', error);
                alert('âŒ ì„±ê³¼ ë¹„êµì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì „ëµ ë¹„êµ ì°¨íŠ¸ ìƒì„±
        function createStrategyComparisonChart(strategyData) {
            const ctx = document.getElementById('strategyComparisonChart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (window.strategyComparisonChart) {
                window.strategyComparisonChart.destroy();
            }

            const strategies = Object.keys(strategyData);
            const avgReturns = strategies.map(strategy => {
                const returns = strategyData[strategy].returns;
                return returns.reduce((sum, ret) => sum + ret, 0) / returns.length;
            });

            window.strategyComparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: strategies,
                    datasets: [{
                        label: 'í‰ê·  ìˆ˜ìµë¥  (%)',
                        data: avgReturns,
                        backgroundColor: ['#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6'],
                        borderColor: ['#2980b9', '#c0392b', '#27ae60', '#e67e22', '#8e44ad'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ì „ëµë³„ í‰ê·  ìˆ˜ìµë¥  ë¹„êµ'
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ìœ„í—˜-ìˆ˜ìµë¥  ì°¨íŠ¸ ìƒì„±
        function createRiskReturnChart(strategyData) {
            const ctx = document.getElementById('riskReturnChart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (window.riskReturnChart) {
                window.riskReturnChart.destroy();
            }

            const datasets = Object.keys(strategyData).map((strategy, index) => {
                const data = strategyData[strategy];
                const avgReturn = data.returns.reduce((sum, ret) => sum + ret, 0) / data.returns.length;
                const avgDrawdown = data.drawdown.reduce((sum, dd) => sum + dd, 0) / data.drawdown.length;
                
                return {
                    label: strategy,
                    data: [{ x: avgDrawdown, y: avgReturn }],
                    backgroundColor: ['#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6'][index],
                    borderColor: ['#2980b9', '#c0392b', '#27ae60', '#e67e22', '#8e44ad'][index],
                    pointRadius: 8,
                    pointHoverRadius: 10
                };
            });

            window.riskReturnChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ìœ„í—˜ ëŒ€ë¹„ ìˆ˜ìµë¥  (ë‚™í­ vs ìˆ˜ìµë¥ )'
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'í‰ê·  ìµœëŒ€ ë‚™í­ (%)'
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'í‰ê·  ìˆ˜ìµë¥  (%)'
                            }
                        }
                    }
                }
            });
        }

        // ì „ëµ ë¹„êµ í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateStrategyComparisonTable(strategyData) {
            const tbody = document.getElementById('strategyComparisonBody');
            tbody.innerHTML = '';

            Object.keys(strategyData).forEach(strategy => {
                const data = strategyData[strategy];
                const avgReturn = (data.returns.reduce((sum, ret) => sum + ret, 0) / data.returns.length).toFixed(2);
                const avgSharpe = (data.sharpe.reduce((sum, sh) => sum + sh, 0) / data.sharpe.length).toFixed(2);
                const avgDrawdown = (data.drawdown.reduce((sum, dd) => sum + dd, 0) / data.drawdown.length).toFixed(2);
                const avgWinRate = (data.winRate.reduce((sum, wr) => sum + wr, 0) / data.winRate.length).toFixed(2);
                const avgLeverage = (data.avgLeverage / data.count).toFixed(2);

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${strategy}</td>
                    <td class="positive">+${avgReturn}%</td>
                    <td>${avgSharpe}</td>
                    <td class="negative">-${avgDrawdown}%</td>
                    <td>${avgWinRate}%</td>
                    <td>${data.totalTrades}</td>
                    <td>${avgLeverage}x</td>
                    <td>${avgReturn > 15 ? 'ë†’ìŒ' : avgReturn > 8 ? 'ì¤‘ê°„' : 'ë‚®ìŒ'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // ì„±ê³¼ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        function updatePerformanceChart(results) {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            
            // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
            if (window.performanceChart) {
                window.performanceChart.destroy();
            }

            // ë‚ ì§œë³„ ëˆ„ì  ìˆ˜ìµë¥  ê³„ì‚°
            const chartData = results.slice(-10).map(result => {
                const totalReturn = ((result.final_value - result.initial_capital) / result.initial_capital * 100);
                return {
                    x: new Date(result.created_at).toLocaleDateString(),
                    y: totalReturn
                };
            });

            window.performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'ë°±í…ŒìŠ¤íŠ¸ ìˆ˜ìµë¥ ',
                        data: chartData,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ìµœê·¼ ë°±í…ŒìŠ¤íŠ¸ ì„±ê³¼ ì¶”ì´'
                        }
                    },
                    scales: {
                        x: {
                            type: 'category',
                            title: {
                                display: true,
                                text: 'í…ŒìŠ¤íŠ¸ ë‚ ì§œ'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'ìˆ˜ìµë¥  (%)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function exportToExcel() {
            // êµ¬í˜„ ì˜ˆì •
            alert('ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ê°œë³„ ê²°ê³¼ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function exportResultToExcel(resultId) {
            // êµ¬í˜„ ì˜ˆì •
            alert('ê°œë³„ ê²°ê³¼ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì´ˆê¸°í™”
        async function resetBacktestResults() {
            if (!confirm('âš ï¸ ëª¨ë“  ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                return;
            }

            try {
                const response = await fetch('/api/backtest/results/reset', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                const result = await response.json();
                
                if (result.error) {
                    throw new Error(result.error);
                }

                // ê²°ê³¼ ê·¸ë¦¬ë“œ ì´ˆê¸°í™”
                const resultsGrid = document.getElementById('resultsGrid');
                resultsGrid.innerHTML = '<div class="no-results">ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë°±í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´ë³´ì„¸ìš”.</div>';

                // í†µê³„ ì´ˆê¸°í™”
                document.getElementById('totalReturn').textContent = '+0.0%';
                document.getElementById('totalTrades').textContent = '0';
                document.getElementById('winRate').textContent = '0.0%';
                document.getElementById('sharpeRatio').textContent = '0.0';
                document.getElementById('maxDrawdown').textContent = '0.0%';
                document.getElementById('avgLeverage').textContent = '0.0x';

                alert('âœ… ëª¨ë“  ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                
            } catch (error) {
                console.error('ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                alert('âŒ ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // í†µê³„ ë³´ê¸°
        async function showStatistics() {
            try {
                const response = await fetch('/api/backtest/statistics');
                const stats = await response.json();
                
                if (stats.error) {
                    throw new Error(stats.error);
                }

                // í†µê³„ ëª¨ë‹¬ HTML ìƒì„±
                const statsHtml = `
                    <div class="stats-section">
                        <h3>ğŸ“Š ì „ëµë³„ í†µê³„</h3>
                        <div class="stats-grid">
                            ${Object.entries(stats.strategy_stats).map(([strategy, data]) => `
                                <div class="stat-card">
                                    <h4>${strategy}</h4>
                                    <p>í…ŒìŠ¤íŠ¸ ìˆ˜: ${data.total_tests}íšŒ</p>
                                    <p>í‰ê·  ìˆ˜ìµë¥ : <span class="positive">+${data.avg_return}%</span></p>
                                    <p>í‰ê·  ìƒ¤í”„ ë¹„ìœ¨: ${data.avg_sharpe}</p>
                                    <p>í‰ê·  ë‚™í­: <span class="negative">-${data.avg_drawdown}%</span></p>
                                    <p>ìŠ¹ë¥ : ${data.win_rate}%</p>
                                    <p>ìµœì  ì‹¬ë³¼: ${data.best_symbol}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="stats-section">
                        <h3>ğŸ’° ì‹¬ë³¼ë³„ í†µê³„</h3>
                        <div class="stats-grid">
                            ${Object.entries(stats.symbol_stats).map(([symbol, data]) => `
                                <div class="stat-card">
                                    <h4>${symbol}</h4>
                                    <p>í…ŒìŠ¤íŠ¸ ìˆ˜: ${data.total_tests}íšŒ</p>
                                    <p>í‰ê·  ìˆ˜ìµë¥ : <span class="positive">+${data.avg_return}%</span></p>
                                    <p>ìµœì  ì „ëµ: ${data.best_strategy}</p>
                                    <p>ìµœì•… ì „ëµ: ${data.worst_strategy}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="stats-section">
                        <h3>ğŸ“… ê¸°ê°„ë³„ í†µê³„</h3>
                        <div class="stats-grid">
                            ${Object.entries(stats.period_stats).map(([period, data]) => `
                                <div class="stat-card">
                                    <h4>${period}</h4>
                                    <p>í…ŒìŠ¤íŠ¸ ìˆ˜: ${data.total_tests}íšŒ</p>
                                    <p>í‰ê·  ìˆ˜ìµë¥ : <span class="positive">+${data.avg_return}%</span></p>
                                    <p>ë³€ë™ì„±: ${data.volatility}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="stats-summary">
                        <h3>ğŸ“ˆ ì „ì²´ ìš”ì•½</h3>
                        <p>ì´ ë°±í…ŒìŠ¤íŠ¸ ìˆ˜: <strong>${stats.total_tests}</strong>íšŒ</p>
                        <p>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date(stats.last_updated).toLocaleString()}</p>
                    </div>
                `;

                // ëª¨ë‹¬ì— í†µê³„ í‘œì‹œ
                document.getElementById('detailContent').innerHTML = statsHtml;
                document.getElementById('detailModal').style.display = 'block';
                
            } catch (error) {
                console.error('í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
                alert('âŒ í†µê³„ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì „ëµ í†µí•© ë¶„ì„ ê´€ë ¨ í•¨ìˆ˜ë“¤
        
        // ë¶„ì„ íƒ­ ì „í™˜
        function showAnalysisTab(tabName) {
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë‚´ìš© ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            document.querySelector(`[onclick="showAnalysisTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + 'Tab').style.display = 'block';
        }

        // ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayComprehensiveAnalysis(analysisData) {
            const comprehensiveSection = document.getElementById('comprehensiveAnalysisSection');
            comprehensiveSection.style.display = 'block';
            
            // ë¶„ì„ ìš”ì•½ ì—…ë°ì´íŠ¸
            document.getElementById('totalStrategiesTested').textContent = analysisData.totalStrategies;
            document.getElementById('bestStrategy').textContent = analysisData.bestStrategy;
            document.getElementById('avgReturn').textContent = analysisData.avgReturn + '%';
            document.getElementById('recommendedStrategies').textContent = analysisData.recommendedStrategies.length;
            
            // ì¶”ì²œ ì „ëµ ëª©ë¡
            const recommendedList = document.getElementById('recommendedStrategiesList');
            recommendedList.innerHTML = '';
            analysisData.recommendedStrategies.forEach(strategy => {
                const item = document.createElement('div');
                item.className = 'strategy-item';
                item.innerHTML = `
                    <h4>${strategy.name}</h4>
                    <p><strong>ìˆ˜ìµë¥ :</strong> <span class="positive">+${strategy.return}%</span></p>
                    <p><strong>ìƒ¤í”„ ë¹„ìœ¨:</strong> ${strategy.sharpe}</p>
                    <p><strong>ì¶”ì²œ ì´ìœ :</strong> ${strategy.reason}</p>
                    <div class="strategy-metrics">
                        <div class="metric-item">
                            <div>ìŠ¹ë¥ </div>
                            <div>${strategy.winRate}%</div>
                        </div>
                        <div class="metric-item">
                            <div>ë‚™í­</div>
                            <div>${strategy.drawdown}%</div>
                        </div>
                        <div class="metric-item">
                            <div>ê±°ë˜ìˆ˜</div>
                            <div>${strategy.trades}</div>
                        </div>
                    </div>
                `;
                recommendedList.appendChild(item);
            });
            
            // ìˆ˜ì • í•„ìš” ì „ëµ ëª©ë¡
            const modificationList = document.getElementById('modificationNeededList');
            modificationList.innerHTML = '';
            analysisData.modificationNeeded.forEach(strategy => {
                const item = document.createElement('div');
                item.className = 'strategy-item';
                item.innerHTML = `
                    <h4>${strategy.name}</h4>
                    <p><strong>ìˆ˜ìµë¥ :</strong> <span class="warning">${strategy.return}%</span></p>
                    <p><strong>ë¬¸ì œì :</strong> ${strategy.issues}</p>
                    <p><strong>ê°œì„  ë°©ì•ˆ:</strong> ${strategy.improvements}</p>
                `;
                modificationList.appendChild(item);
            });
            
            // íê¸° ê¶Œì¥ ì „ëµ ëª©ë¡
            const discardList = document.getElementById('discardRecommendedList');
            discardList.innerHTML = '';
            analysisData.discardRecommended.forEach(strategy => {
                const item = document.createElement('div');
                item.className = 'strategy-item';
                item.innerHTML = `
                    <h4>${strategy.name}</h4>
                    <p><strong>ìˆ˜ìµë¥ :</strong> <span class="negative">${strategy.return}%</span></p>
                    <p><strong>íê¸° ì´ìœ :</strong> ${strategy.reason}</p>
                    <p><strong>ìœ„í—˜ë„:</strong> ${strategy.risk}</p>
                `;
                discardList.appendChild(item);
            });
            
            // ì¡°í•© ì¶”ì²œ ëª©ë¡
            const combinationList = document.getElementById('combinationRecommendations');
            combinationList.innerHTML = '';
            analysisData.combinationRecommendations.forEach(combo => {
                const item = document.createElement('div');
                item.className = 'recommendation-item';
                item.innerHTML = `
                    <div class="recommendation-title">${combo.name}</div>
                    <div class="recommendation-reason">${combo.reason}</div>
                    <div class="recommendation-metrics">
                        <span>ì˜ˆìƒ ìˆ˜ìµë¥ : <strong class="positive">+${combo.expectedReturn}%</strong></span>
                        <span>ìœ„í—˜ë„: <strong>${combo.risk}</strong></span>
                        <span>ìƒê´€ê³„ìˆ˜: <strong>${combo.correlation}</strong></span>
                    </div>
                `;
                combinationList.appendChild(item);
            });
            
            // ìƒì„¸ ë¶„ì„ ë‚´ìš© ì—…ë°ì´íŠ¸
            updateDetailedAnalysis(analysisData);
            
            // ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            comprehensiveSection.scrollIntoView({ behavior: 'smooth' });
        }

        // ìƒì„¸ ë¶„ì„ ì—…ë°ì´íŠ¸
        function updateDetailedAnalysis(analysisData) {
            // ì„±ê³¼ ë¶„ì„
            const performanceAnalysis = document.getElementById('performanceAnalysis');
            performanceAnalysis.innerHTML = `
                <h4>ì„±ê³¼ ë¶„ì„ ìš”ì•½</h4>
                <div class="analysis-summary">
                    <p><strong>ìµœê³  ì„±ê³¼ ì „ëµ:</strong> ${analysisData.bestStrategy} (+${analysisData.bestReturn}%)</p>
                    <p><strong>ìµœì € ì„±ê³¼ ì „ëµ:</strong> ${analysisData.worstStrategy} (${analysisData.worstReturn}%)</p>
                    <p><strong>í‰ê·  ìˆ˜ìµë¥ :</strong> ${analysisData.avgReturn}%</p>
                    <p><strong>ìˆ˜ìµë¥  í‘œì¤€í¸ì°¨:</strong> ${analysisData.returnStdDev}%</p>
                </div>
                <div class="insights">
                    <h5>ì£¼ìš” ì¸ì‚¬ì´íŠ¸:</h5>
                    <ul>
                        ${analysisData.performanceInsights.map(insight => `<li>${insight}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            // ìœ„í—˜ ë¶„ì„
            const riskAnalysis = document.getElementById('riskAnalysis');
            riskAnalysis.innerHTML = `
                <h4>ìœ„í—˜ ë¶„ì„ ìš”ì•½</h4>
                <div class="analysis-summary">
                    <p><strong>ìµœëŒ€ ë‚™í­ í‰ê· :</strong> ${analysisData.avgMaxDrawdown}%</p>
                    <p><strong>ìµœê³  ìœ„í—˜ ì „ëµ:</strong> ${analysisData.highestRiskStrategy} (${analysisData.highestRisk}%)</p>
                    <p><strong>ìµœì € ìœ„í—˜ ì „ëµ:</strong> ${analysisData.lowestRiskStrategy} (${analysisData.lowestRisk}%)</p>
                </div>
                <div class="insights">
                    <h5>ìœ„í—˜ ê´€ë¦¬ ì œì•ˆ:</h5>
                    <ul>
                        ${analysisData.riskInsights.map(insight => `<li>${insight}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            // ìƒê´€ê´€ê³„ ë¶„ì„
            const correlationAnalysis = document.getElementById('correlationAnalysis');
            correlationAnalysis.innerHTML = `
                <h4>ì „ëµ ê°„ ìƒê´€ê´€ê³„</h4>
                <div class="analysis-summary">
                    <p><strong>í‰ê·  ìƒê´€ê³„ìˆ˜:</strong> ${analysisData.avgCorrelation}</p>
                    <p><strong>ìµœê³  ìƒê´€ê³„ìˆ˜:</strong> ${analysisData.highestCorrelation}</p>
                    <p><strong>ìµœì € ìƒê´€ê³„ìˆ˜:</strong> ${analysisData.lowestCorrelation}</p>
                </div>
                <div class="insights">
                    <h5>ë‹¤ê°í™” ì œì•ˆ:</h5>
                    <ul>
                        ${analysisData.correlationInsights.map(insight => `<li>${insight}</li>`).join('')}
                    </ul>
                </div>
            `;
            
            // ì¸ì‚¬ì´íŠ¸
            const insightsContent = document.getElementById('insightsContent');
            insightsContent.innerHTML = `
                <div class="insights-section">
                    <h4>ğŸ¯ í•µì‹¬ ì¸ì‚¬ì´íŠ¸</h4>
                    <div class="insight-cards">
                        ${analysisData.keyInsights.map(insight => `
                            <div class="card" style="margin-bottom: 1rem; padding: 1.5rem;">
                                <h5 style="color: #3498db;">${insight.title}</h5>
                                <p>${insight.description}</p>
                                <div class="insight-action">
                                    <strong>ì•¡ì…˜ ì•„ì´í…œ:</strong> ${insight.action}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="recommendations-section">
                    <h4>ğŸ“‹ êµ¬ì²´ì  ê¶Œì¥ì‚¬í•­</h4>
                    <div class="recommendation-cards">
                        ${analysisData.recommendations.map(rec => `
                            <div class="card" style="margin-bottom: 1rem; padding: 1.5rem; border-left: 4px solid #27ae60;">
                                <h5 style="color: #27ae60;">${rec.title}</h5>
                                <p>${rec.description}</p>
                                <div class="recommendation-priority">
                                    <strong>ìš°ì„ ìˆœìœ„:</strong> <span class="priority-${rec.priority}">${rec.priority}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
        function exportComprehensiveAnalysis() {
            alert('ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ìµœì í™” í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±
        function generateOptimizedPortfolio() {
            alert('ìµœì í™” í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ì „ëµ í†µí•© ë¶„ì„ ì´ˆê¸°í™”
        function resetComprehensiveAnalysis() {
            if (confirm('ì „ëµ í†µí•© ë¶„ì„ ê²°ê³¼ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('comprehensiveAnalysisSection').style.display = 'none';
                alert('ì „ëµ í†µí•© ë¶„ì„ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ë”ë¯¸ ë°ì´í„°ë¡œ ì „ëµ í†µí•© ë¶„ì„ í…ŒìŠ¤íŠ¸ (ê°œë°œìš©)
        function testComprehensiveAnalysis() {
            const dummyData = {
                totalStrategies: 8,
                bestStrategy: 'ML ì•™ìƒë¸”',
                avgReturn: 18.5,
                bestReturn: 28.6,
                worstStrategy: 'ê·¸ë¦¬ë“œ íŠ¸ë ˆì´ë”©',
                worstReturn: 15.6,
                returnStdDev: 6.8,
                avgMaxDrawdown: 10.2,
                highestRiskStrategy: 'ëª¨ë©˜í…€ ì „ëµ',
                highestRisk: 18.7,
                lowestRiskStrategy: 'ì°¨ìµê±°ë˜',
                lowestRisk: 3.2,
                avgCorrelation: 0.35,
                highestCorrelation: 0.78,
                lowestCorrelation: -0.12,
                recommendedStrategies: [
                    {
                        name: 'ML ì•™ìƒë¸”',
                        return: 28.6,
                        sharpe: 2.15,
                        reason: 'ë†’ì€ ìˆ˜ìµë¥ ê³¼ ì•ˆì •ì„±ì„ ë™ì‹œì— ì œê³µ',
                        winRate: 71.2,
                        drawdown: 11.4,
                        trades: 52
                    },
                    {
                        name: 'íŠ¸ë¦¬í”Œ ì½¤ë³´',
                        return: 25.4,
                        sharpe: 1.85,
                        reason: 'ì¼ê´€ëœ ì„±ê³¼ì™€ ì ì ˆí•œ ìœ„í—˜ ê´€ë¦¬',
                        winRate: 68.9,
                        drawdown: 8.5,
                        trades: 45
                    }
                ],
                modificationNeeded: [
                    {
                        name: 'MACD ì „ëµ',
                        return: 22.1,
                        issues: 'ë†’ì€ ë³€ë™ì„±ê³¼ ë¶ˆì•ˆì •í•œ ì‹ í˜¸',
                        improvements: 'ì‹ í˜¸ í•„í„°ë§ ê°•í™”, í¬ì§€ì…˜ í¬ê¸° ì¡°ì ˆ'
                    }
                ],
                discardRecommended: [
                    {
                        name: 'ê·¸ë¦¬ë“œ íŠ¸ë ˆì´ë”©',
                        return: 15.6,
                        reason: 'ë‚®ì€ ìˆ˜ìµë¥ ê³¼ ë†’ì€ ê±°ë˜ ë¹„ìš©',
                        risk: 'ì¤‘ê°„'
                    }
                ],
                combinationRecommendations: [
                    {
                        name: 'ML ì•™ìƒë¸” + íŠ¸ë¦¬í”Œ ì½¤ë³´',
                        reason: 'ìƒí˜¸ ë³´ì™„ì ì¸ ì‹ í˜¸ë¡œ ì•ˆì •ì„± í–¥ìƒ',
                        expectedReturn: 26.8,
                        risk: 'ì¤‘ê°„',
                        correlation: 0.42
                    }
                ],
                performanceInsights: [
                    'ML ìµœì í™”ëœ ì „ëµë“¤ì´ ì¼ë°˜ì ìœ¼ë¡œ ë” ë†’ì€ ìˆ˜ìµë¥ ì„ ê¸°ë¡',
                    'ëª¨ë©˜í…€ ê¸°ë°˜ ì „ëµë“¤ì´ ë†’ì€ ìˆ˜ìµë¥ ì„ ë³´ì´ë‚˜ ìœ„í—˜ë„ë„ ë†’ìŒ',
                    'ì°¨ìµê±°ë˜ ì „ëµì€ ì•ˆì •ì ì´ì§€ë§Œ ìˆ˜ìµë¥ ì´ ì œí•œì '
                ],
                riskInsights: [
                    'í¬íŠ¸í´ë¦¬ì˜¤ ë‹¤ê°í™”ë¡œ ì „ì²´ ìœ„í—˜ë„ë¥¼ 30% ì´ìƒ ê°ì†Œ ê°€ëŠ¥',
                    'ë ˆë²„ë¦¬ì§€ ì¡°ì ˆì„ í†µí•œ ìœ„í—˜ ê´€ë¦¬ê°€ í•„ìš”',
                    'ì‹œì¥ ë³€ë™ì„±ì´ ë†’ì€ ê¸°ê°„ì—ëŠ” ë³´ìˆ˜ì  ì „ëµ ë¹„ì¤‘ í™•ëŒ€ ê¶Œì¥'
                ],
                correlationInsights: [
                    'íŠ¸ë ˆì´ë”© ìŠ¤íƒ€ì¼ì´ ë‹¤ë¥¸ ì „ëµë“¤ì˜ ì¡°í•©ìœ¼ë¡œ ë‹¤ê°í™” íš¨ê³¼ ê·¹ëŒ€í™”',
                    'ML ì•™ìƒë¸”ê³¼ ì°¨ìµê±°ë˜ ì „ëµì˜ ì¡°í•©ì´ ê°€ì¥ íš¨ê³¼ì ',
                    'ëª¨ë©˜í…€ ì „ëµë“¤ ê°„ì˜ ë†’ì€ ìƒê´€ê´€ê³„ë¡œ ì¤‘ë³µ íˆ¬ì ìœ„í—˜ ì¡´ì¬'
                ],
                keyInsights: [
                    {
                        title: 'ê¸°ê³„í•™ìŠµ ì „ëµì˜ ìš°ìœ„',
                        description: 'ML ìµœì í™”ëœ ì „ëµë“¤ì´ ì „ë°˜ì ìœ¼ë¡œ ë” ë†’ì€ ìœ„í—˜ ì¡°ì • ìˆ˜ìµë¥ ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.',
                        action: 'ML ìµœì í™”ë¥¼ ëª¨ë“  ì „ëµì— ì ìš© ê²€í† '
                    },
                    {
                        title: 'í¬íŠ¸í´ë¦¬ì˜¤ ë‹¤ê°í™”ì˜ í•„ìš”ì„±',
                        description: 'ë‹¨ì¼ ì „ëµ ì˜ì¡´ë„ë¥¼ ì¤„ì´ê³  ìƒê´€ê´€ê³„ê°€ ë‚®ì€ ì „ëµë“¤ì„ ì¡°í•©í•˜ì—¬ ì•ˆì •ì„±ì„ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                        action: '3-4ê°œ ì „ëµì„ ì¡°í•©í•œ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±'
                    }
                ],
                recommendations: [
                    {
                        title: 'í•µì‹¬ ì „ëµ ì„ ë³„',
                        description: 'ML ì•™ìƒë¸”, íŠ¸ë¦¬í”Œ ì½¤ë³´, ëª¨ë©˜í…€ ì „ëµì„ í•µì‹¬ ì „ëµìœ¼ë¡œ ì„ ì •í•˜ì—¬ í¬íŠ¸í´ë¦¬ì˜¤ì˜ 70% ë¹„ì¤‘ í• ë‹¹',
                        priority: 'ë†’ìŒ'
                    },
                    {
                        title: 'ìœ„í—˜ ê´€ë¦¬ ê°•í™”',
                        description: 'ê° ì „ëµë³„ ìµœëŒ€ ì†ì‹¤ í•œë„ë¥¼ ì„¤ì •í•˜ê³  ì‹œì¥ ë³€ë™ì„±ì— ë”°ë¥¸ ë™ì  í¬ì§€ì…˜ í¬ê¸° ì¡°ì ˆ',
                        priority: 'ë†’ìŒ'
                    },
                    {
                        title: 'ì„±ê³¼ ëª¨ë‹ˆí„°ë§',
                        description: 'ì›”ë³„ ì„±ê³¼ ë¦¬ë·°ë¥¼ í†µí•´ ì „ëµë³„ ì„±ê³¼ë¥¼ ì¶”ì í•˜ê³  í•„ìš”ì‹œ ë¹„ì¤‘ ì¡°ì •',
                        priority: 'ì¤‘ê°„'
                    }
                ]
            };
            
            displayComprehensiveAnalysis(dummyData);
        }
    </script>
</body>
</html>